(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1099:function(e,t){},1134:function(e,t){},1141:function(e,t){},1143:function(e,t){},1163:function(e,t){},1165:function(e,t){},1172:function(e,t){},1174:function(e,t){},1182:function(e,t){},1293:function(e,t){},1363:function(e,t){},1365:function(e,t){},1368:function(e,t){},1401:function(e,t){},1414:function(e,t){},1416:function(e,t){},1420:function(e,t){},1457:function(e,t){},1716:function(e,t,n){"use strict";n.r(t);var a=n(674),r=n(6),o=n.n(r),i=n(211),c=n.n(i),s=n(667);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var u=n(214),l=n(675),m=n(173),d=n(672),p=n(673).a.fromJS({hello:"world"}),h={};var f=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||m.c,v=Object(m.d)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;if(h[t.type])return h[t.type](e,t)},f(Object(m.a)(d.a)));n(1701);Object(a.a)();var b=Object(u.createMuiTheme)({typography:{useNextVariants:!0}});c.a.render(o.a.createElement(l.a,{store:v},o.a.createElement(u.MuiThemeProvider,{theme:b},o.a.createElement(s.a,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},438:function(e,t){},667:function(e,t,n){"use strict";(function(e){var a=n(34),r=n.n(a),o=n(676),i=n(124),c=n(213),s=n(283),u=n(289),l=n(171),m=n(284),d=n(6),p=n.n(d),h=n(214),f=n(391),v=n.n(f),b=n(143),g=n.n(b),w=n(668),y=n.n(w),E=n(669),x=n.n(E),O=n(670),k=n.n(O),S=n(98),C=n(285),j=n.n(C),I=function(e){return new Promise(function(t){return setTimeout(t,e)})};function T(e){try{return JSON.parse(new TextDecoder("utf-8").decode(e))}catch(t){return}}function N(t){return e.from(JSON.stringify(t))}var D=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={chan:window.location.hash.slice(1)||void 0,uiType:void 0,msgs:[],streams:[]},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"startComputer",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t,n,a=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return{},t=this.state.chan,this.setState({uiType:"computer"}),t||(t=Math.random().toString(36).slice(2),this.setState({chan:t})),n={},e.next=7,S.a.pubsub.subscribe("solsort-camera-remote-"+t,function(){var e=Object(i.a)(r.a.mark(function e(i){var c,s,u,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c=a.state.msgs,s=T(i.data),console.log("solsort-camera-remote-"+t,"data",s,i),s&&(a.setState({msgs:c.concat([Object(o.a)({recvFrom:i.from,recvDate:(new Date).toISOString()},s)])}),"signal"===s.type&&(u=i.from,(l=n[u])||((l={peer:new j.a}).sending=void 0,l.sender=setInterval(function(){return l.sending&&S.a.pubsub.publish("solsort-camera-remote-"+t,l.sending)},8e3),l.peer.on("signal",function(e){l.sending=N({to:u,data:e}),S.a.pubsub.publish("solsort-camera-remote-"+t,l.sending)}),l.peer.on("connect",function(){delete l.sending,clearInterval(l.sender),delete l.sender,S.a.pubsub.publish("solsort-camera-remote-"+t,N({id:u,connected:!0}))}),n[u]=l,l.peer.on("stream",function(e){var t=a.state.streams;a.setState({streams:t.concat([{stream:e,id:u}])})})),l.peer.signal(s.data)));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"startCamera",value:function(){var e=Object(i.a)(r.a.mark(function e(){var t,n,a,o,c,s,u,l=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.setState({uiType:"camera"}),e.next=4,I(300);case 4:return e.next=6,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 6:return t=e.sent,(n=document.getElementById("cameraPreview")).srcObject=t,n.play(),a=function(){var e=Object(i.a)(r.a.mark(function e(){var t,a,o,i,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l.state.chan){e.next=13;break}return e.next=3,I(1e3);case 3:(t=document.getElementById("capturedFrame")).width=n.videoWidth,t.height=n.videoHeight,(a=t.getContext("2d")).drawImage(n,0,0,t.width,t.height),o=a.getImageData(0,0,t.width,t.height),i=o.data,(c=y()(i,t.width,t.height))&&l.setState({chan:c.data.replace(/^.*#/,"")}),e.next=0;break;case 13:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),e.next=13,a();case 13:return o=this.state.chan,c=new j.a({initiator:!0,stream:t}),s=void 0,u=setInterval(function(){return s&&S.a.pubsub.publish("solsort-camera-remote-"+o,N({typs:"signal",data:s}))},5e3),e.next=19,S.a.pubsub.subscribe("solsort-camera-remote-"+o,function(){var e=Object(i.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=T(t.data))){e.next=16;break}return e.t0=console,e.t1=n.to,e.next=6,S.a.id();case 6:return e.t2=e.sent.id,e.t0.log.call(e.t0,"xxx",e.t1,e.t2),e.t3=n.to,e.next=11,S.a.id();case 11:if(e.t4=e.sent.id,e.t3!==e.t4){e.next=16;break}console.log("here!",t.data),clearInterval(u),c.signal(n.data);case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 19:c.on("signal",function(e){s=e,S.a.pubsub.publish("solsort-camera-remote-"+o,N({type:"signal",data:e}))}),c.on("connect",function(){return console.log("CONNECTED")}),e.next=27;break;case 23:throw e.prev=23,e.t0=e.catch(0),console.log("startCamera error",e.t0),e.t0;case 27:case"end":return e.stop()}},e,this,[[0,23]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=this.state.streams,t=!0,n=!1,a=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=r.value,c=i.id,s=i.stream,u=document.getElementById(c);console.log("didUpdate",u,s),u.srcObject=s,u.play()}}catch(l){n=!0,a=l}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}}},{key:"renderComputer",value:function(){this.props.classes;var e=this.state,t=e.chan,n=e.msgs,a=e.streams,r=window.location.href.replace(/#.*./,"")+"#"+t;return p.a.createElement("div",null,a.map(function(e){var t=e.id;e.stream,e.streamUrl;return p.a.createElement("span",{key:t},p.a.createElement("video",{id:t}))}),p.a.createElement("center",null,p.a.createElement("br",null),p.a.createElement("div",{style:{display:"inline-block",width:520,textAlign:"left"}},p.a.createElement("div",{style:{float:"right",marginLeft:8}},p.a.createElement(k.a,{value:r})),p.a.createElement(g.a,{variant:"h3",gutterBottom:!0},"Connect camera"),p.a.createElement(g.a,null,"To connect a camera, open the web-app, scan the QR-code, or open the following url on your mobile phone / device: ",p.a.createElement("br",null)," ",p.a.createElement("code",null,r),p.a.createElement("br",null)))),p.a.createElement("hr",null),"Debug:",p.a.createElement("pre",null,JSON.stringify(n,null,4)))}},{key:"renderCamera",value:function(){this.props.classes;var e=this.state.chan;return p.a.createElement("center",null,!e&&p.a.createElement("div",{style:{position:"fixed",left:"50%",width:320,marginLeft:-160,top:50,display:"inline-block",textShadow:"1px 1px 4px white"}},p.a.createElement(g.a,{variant:"h4",gutterBottom:!0},"Point the camera to the QR-code on the computer to connect.")),p.a.createElement("video",{style:{maxWidth:window.innerWidth,maxHeight:window.innerHeight},id:"cameraPreview"})," ",p.a.createElement("br",null),p.a.createElement("canvas",{id:"capturedFrame"}))}},{key:"render",value:function(){var e=this,t=this.state.uiType,n=this.props.classes;return"computer"===t?this.renderComputer():"camera"===t?this.renderCamera():p.a.createElement("center",null,p.a.createElement(g.a,{gutterBottom:!0,variant:"h2"},"Camera Remote"),p.a.createElement(g.a,null,"Is this the UI on a computer/tablet or is it a camera/tablet/phone?"),p.a.createElement(v.a,{variant:"contained",color:"primary",className:n.button,onClick:function(){return e.startComputer()}},"Computer"),p.a.createElement(v.a,{variant:"contained",color:"primary",className:n.button,onClick:function(){return e.startCamera()}},"Camera"),p.a.createElement(g.a,{component:"div"},p.a.createElement("div",{style:{textAlign:"left",maxWidth:"60ex"}},p.a.createElement(x.a,{source:"\n### About\n\nThis is a simple tool for connecting a UI running on a computer/tablet with the camera of a mobile phone or similar. No-server proof of concept using IPFS/WebRTC. This experiment might be used for a stop-motion web/app later on.\n            ".trim()}))))}}]),t}(d.Component);t.a=Object(h.withStyles)(function(e){return{button:{margin:e.spacing.unit}}})(D)}).call(this,n(0).Buffer)},681:function(e,t,n){e.exports=n(1716)},878:function(e,t){},891:function(e,t){},898:function(e,t){},900:function(e,t){},978:function(e,t){},98:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(34),r=n.n(a),o=n(124),i=new(n(773))({EXPERIMENTAL:{pubsub:!0,dht:!0},config:{Addresses:{Swarm:["/dns4/ws-star.discovery.libp2p.io/tcp/443/wss/p2p-websocket-star"]}}});Math.random().toString(36).slice(2);window.ipfs=i,i.on("ready",Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{console.log("IPFS READY")}catch(t){console.log("ipfserr",t)}case 1:case"end":return e.stop()}},e)}))),i.on("error",function(e){console.error("IPFS Error:",e)})},980:function(e,t){}},[[681,1,2]]]);
//# sourceMappingURL=main.17acfc18.chunk.js.map