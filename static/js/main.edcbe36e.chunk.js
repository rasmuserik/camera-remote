(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var a=n(34),r=n.n(a),o=n(124),i=new(n(773))({EXPERIMENTAL:{pubsub:!0,dht:!0},config:{Addresses:{Swarm:["/dns4/ws-star.discovery.libp2p.io/tcp/443/wss/p2p-websocket-star"]}}});Math.random().toString(36).slice(2);window.ipfs=i,i.on("ready",Object(o.a)(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:try{console.log("IPFS READY")}catch(e){console.log("ipfserr",e)}case 1:case"end":return t.stop()}},t)}))),i.on("error",function(t){console.error("IPFS Error:",t)})},1099:function(t,e){},1134:function(t,e){},1141:function(t,e){},1143:function(t,e){},1163:function(t,e){},1165:function(t,e){},1172:function(t,e){},1174:function(t,e){},1182:function(t,e){},1293:function(t,e){},1363:function(t,e){},1365:function(t,e){},1368:function(t,e){},1401:function(t,e){},1414:function(t,e){},1416:function(t,e){},1420:function(t,e){},1457:function(t,e){},1716:function(t,e,n){"use strict";n.r(e);var a=n(674),r=n(6),o=n.n(r),i=n(211),c=n.n(i),s=n(667);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var u=n(214),l=n(675),m=n(173),p=n(672),d=n(673).a.fromJS({hello:"world"}),h={};var f=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||m.c,v=Object(m.d)(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,e=arguments.length>1?arguments[1]:void 0;if(h[e.type])return h[e.type](t,e)},f(Object(m.a)(p.a)));n(1701);Object(a.a)();var b=Object(u.createMuiTheme)({typography:{useNextVariants:!0}});c.a.render(o.a.createElement(l.a,{store:v},o.a.createElement(u.MuiThemeProvider,{theme:b},o.a.createElement(s.a,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},438:function(t,e){},667:function(t,e,n){"use strict";(function(t){var a=n(34),r=n.n(a),o=n(676),i=n(124),c=n(213),s=n(283),u=n(289),l=n(171),m=n(284),p=n(6),d=n.n(p),h=n(214),f=n(391),v=n.n(f),b=n(143),w=n.n(b),g=n(668),y=n.n(g),E=n(669),x=n.n(E),O=n(670),k=n.n(O),S=n(106),j=n(285),C=n.n(j),I=function(t){return new Promise(function(e){return setTimeout(e,t)})};function T(t){try{return JSON.parse(new TextDecoder("utf-8").decode(t))}catch(e){return}}function N(e){return t.from(JSON.stringify(e))}var D=function(t){function e(){var t,n;Object(c.a)(this,e);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(t=Object(l.a)(e)).call.apply(t,[this].concat(r)))).state={chan:window.location.hash.slice(1)||void 0,uiType:void 0,msgs:[],streams:[]},n}return Object(m.a)(e,t),Object(s.a)(e,[{key:"startComputer",value:function(){var t=Object(i.a)(r.a.mark(function t(){var e,n,a=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return{},e=this.state.chan,this.setState({uiType:"computer"}),e||(e=Math.random().toString(36).slice(2),this.setState({chan:e})),n={},t.next=7,S.a.pubsub.subscribe("solsort-stop-motion-"+e,function(){var t=Object(i.a)(r.a.mark(function t(i){var c,s,u,l;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=a.state.msgs,s=T(i.data),console.log("solsort-stop-motion-"+e,"data",s,i),s&&(a.setState({msgs:c.concat([Object(o.a)({recvFrom:i.from,recvDate:(new Date).toISOString()},s)])}),"signal"===s.type&&(u=i.from,(l=n[u])||((l={peer:new C.a}).peer.on("signal",function(t){S.a.pubsub.publish("solsort-stop-motion-"+e,N({to:u,data:t}))}),l.peer.on("connect",function(){return S.a.pubsub.publish("solsort-stop-motion-"+e,N({id:u,connected:!0}))}),n[u]=l,l.peer.on("stream",function(t){var e=a.state.streams;a.setState({streams:e.concat([{stream:t,id:u}])})})),l.peer.signal(s.data)));case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"startCamera",value:function(){var t=Object(i.a)(r.a.mark(function t(){var e,n,a,o,c,s,u,l=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.setState({uiType:"camera"}),t.next=4,I(300);case 4:return t.next=6,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 6:return e=t.sent,(n=document.getElementById("cameraPreview")).srcObject=e,n.play(),a=function(){var t=Object(i.a)(r.a.mark(function t(){var e,a,o,i,c;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(l.state.chan){t.next=13;break}return t.next=3,I(1e3);case 3:(e=document.getElementById("capturedFrame")).width=n.videoWidth,e.height=n.videoHeight,(a=e.getContext("2d")).drawImage(n,0,0,e.width,e.height),o=a.getImageData(0,0,e.width,e.height),i=o.data,(c=y()(i,e.width,e.height))&&l.setState({chan:c.data.replace(/^.*#/,"")}),t.next=0;break;case 13:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),t.next=13,a();case 13:return o=this.state.chan,c=new C.a({initiator:!0,stream:e}),s=void 0,u=setInterval(function(){return s&&S.a.pubsub.publish("solsort-stop-motion-"+o,N({typs:"signal",data:s}))},5e3),t.next=19,S.a.pubsub.subscribe("solsort-stop-motion-"+o,function(){var t=Object(i.a)(r.a.mark(function t(e){var n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=T(e.data))){t.next=16;break}return t.t0=console,t.t1=n.to,t.next=6,S.a.id();case 6:return t.t2=t.sent.id,t.t0.log.call(t.t0,"xxx",t.t1,t.t2),t.t3=n.to,t.next=11,S.a.id();case 11:if(t.t4=t.sent.id,t.t3!==t.t4){t.next=16;break}console.log("here!",e.data),clearInterval(u),c.signal(n.data);case 16:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 19:c.on("signal",function(t){s=t,S.a.pubsub.publish("solsort-stop-motion-"+o,N({type:"signal",data:t}))}),c.on("connect",function(){return console.log("CONNECTED")}),t.next=27;break;case 23:throw t.prev=23,t.t0=t.catch(0),console.log("startCamera error",t.t0),t.t0;case 27:case"end":return t.stop()}},t,this,[[0,23]])}));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var t=this.state.streams,e=!0,n=!1,a=void 0;try{for(var r,o=t[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value,c=i.id,s=i.stream,u=document.getElementById(c);console.log("didUpdate",u,s),u.srcObject=s,u.play()}}catch(l){n=!0,a=l}finally{try{e||null==o.return||o.return()}finally{if(n)throw a}}}},{key:"renderComputer",value:function(){this.props.classes;var t=this.state,e=t.chan,n=t.msgs,a=t.streams,r=window.location.href.replace(/#.*./,"")+"#"+e;return d.a.createElement("div",null,a.map(function(t){var e=t.id;t.stream,t.streamUrl;return d.a.createElement("span",{key:e},e,d.a.createElement("video",{id:e}))}),d.a.createElement("center",null,d.a.createElement("br",null),d.a.createElement("div",{style:{display:"inline-block",width:520,textAlign:"left"}},d.a.createElement("div",{style:{float:"right",marginLeft:8}},d.a.createElement(k.a,{value:r})),d.a.createElement(w.a,{variant:"h3",gutterBottom:!0},"Connect camera"),d.a.createElement(w.a,null,"To connect a camera, open the web-app, scan the QR-code, or open the following url on your mobile phone / device: ",d.a.createElement("br",null)," ",d.a.createElement("code",null,r),d.a.createElement("br",null)))),d.a.createElement("pre",null,JSON.stringify(n,null,4)))}},{key:"renderCamera",value:function(){this.props.classes;var t=this.state.chan;return d.a.createElement("center",null,!t&&d.a.createElement("div",{style:{position:"fixed",left:"50%",width:320,marginLeft:-160,top:50,display:"inline-block",textShadow:"1px 1px 4px white"}},d.a.createElement(w.a,{variant:"h4",gutterBottom:!0},"Point the camera to the QR-code on the computer to connect.")),d.a.createElement("video",{style:{maxWidth:window.innerWidth,maxHeight:window.innerHeight},id:"cameraPreview"})," ",d.a.createElement("br",null),d.a.createElement("canvas",{id:"capturedFrame"}))}},{key:"render",value:function(){var t=this,e=this.state.uiType,n=this.props.classes;return"computer"===e?this.renderComputer():"camera"===e?this.renderCamera():d.a.createElement("center",null,d.a.createElement(w.a,{gutterBottom:!0,variant:"h2"},"Stop Motion"),d.a.createElement(w.a,null,"Is this the UI on a computer/tablet or is it a camera/tablet/phone?"),d.a.createElement(v.a,{variant:"contained",color:"primary",className:n.button,onClick:function(){return t.startComputer()}},"Computer"),d.a.createElement(v.a,{variant:"contained",color:"primary",className:n.button,onClick:function(){return t.startCamera()}},"Camera"),d.a.createElement(w.a,{component:"div"},d.a.createElement("div",{style:{textAlign:"left",maxWidth:"60ex"}},d.a.createElement(x.a,{source:"\n### About\n\n\nThis is a simple tool for making stop motion animations, with a UI running on a computer/tablet while using a mobile phone or similar as a remote controlled camera. \n\n\n            ".trim()}))))}}]),e}(p.Component);e.a=Object(h.withStyles)(function(t){return{button:{margin:t.spacing.unit}}})(D)}).call(this,n(0).Buffer)},681:function(t,e,n){t.exports=n(1716)},878:function(t,e){},891:function(t,e){},898:function(t,e){},900:function(t,e){},978:function(t,e){},980:function(t,e){}},[[681,1,2]]]);
//# sourceMappingURL=main.edcbe36e.chunk.js.map